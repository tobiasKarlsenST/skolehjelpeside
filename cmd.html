<!DOCTYPE html>
<html>
    <head>
        <link rel="stylesheet" href="styles.css">
        <title>CMD - Hjelpeside for IT Strand</title>

        
    </head>
    <body>
        <div class="navBar">
            <a href="index.html"><div class="left"><div class="logo"><img class="logoImg" alt="Strand vgs" src="https://png.pngtree.com/png-vector/20250902/ourmid/pngtree-minimalist-white-computer-monitor-icon-on-black-background-png-image_17214120.webp">Strand.IT</div></div></a>            <div class="right">Knapp?</div>
        </div>
        <div class="content">
            <h1>CMD/PowerShell Commands</h1>
            <p><strong>Kj√∏r CMD som administrator!</strong></p>

            
            <div id="cmd-container"></div>
        </div>
        <script>
            const sheetUrl = "https://script.googleusercontent.com/macros/echo?user_content_key=AehSKLivj4H7euyzAm0MWB3wb68Pg3FAuHhkDm82m3jI26r-q8COeny8Zc3ZW4oX1TQee0E1JAYpZeIcHWdOPJ8EfdO_aRwlFhrUbUse8iVdlQIZCf8OeyuuCqYzg0tInqvxahFZcpcpXP_UXZMYCTgve6USyuyK1ZdkmtRKtHuLGvMG-OnbiFtJ14shY4LjpTC3TMOwNuzUjZWlxgTAq1hrjoYnd7uqNNunAeHBhsyFQAfLc2kjOIWqE_28spdY_xWYdDqUir34V7j_A-zBXPO3Ga4I1aUaTw&lib=MoPesbO-_SN0qATgGoC6Hbu_f9Eepb8L8";
        
            async function loadCommands() {
                const res = await fetch(sheetUrl);
                const data = await res.json();

                // Grupper etter kategori
                const categories = {};
                data.forEach(item => {
                    if (!categories[item.category]) categories[item.category] = [];
                    categories[item.category].push(item);
                });

                const container = document.getElementById("cmd-container");

                for (const category in categories) {
                    const items = categories[category];

                    let html = `<table>
                                    <tbody>
                                        <tr>
                                            <td colspan="2" style="padding:0;">
                                                <div class="tableHeading"><h2>${category}</h2></div>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td class="tableUnderHeadings"><strong>Command</strong></td>
                                            <td class="tableUnderHeadings"><strong>Beskrivelse</strong></td>
                                        </tr>`;

                    items.forEach(cmd => {
                        html += `<tr>
                                    <td><div class="command">${cmd.command}</div></td>
                                    <td>${cmd.description}</td>
                                </tr>`;
                    });

                    html += `</tbody></table><br>`;
                    container.innerHTML += html;
                }

                // Copy-click
                document.querySelectorAll(".command").forEach(cmd => {
                    cmd.addEventListener("click", () => {
                        navigator.clipboard.writeText(cmd.textContent);
                        const original = cmd.textContent;
                        cmd.textContent = "Kopiert!";
                        setTimeout(() => cmd.textContent = original, 1000);
                    });
                });
            }
            loadCommands();
        </script>
    </body>
</html>