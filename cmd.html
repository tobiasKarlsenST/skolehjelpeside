<!DOCTYPE html>
<html>
    <head>
        <link rel="stylesheet" href="styles.css">
        <title>CMD - Hjelpeside for IT Strand</title>

        
    </head>
    <body>
        <div class="navBar">
            <a href="index.html"><div class="left"><div class="logo"><img class="logoImg" alt="Strand vgs" src="https://png.pngtree.com/png-vector/20250902/ourmid/pngtree-minimalist-white-computer-monitor-icon-on-black-background-png-image_17214120.webp">Strand.IT</div></div></a>            <div class="right">Knapp?</div>
        </div>
        <div class="content">
            <h1>CMD/PowerShell Commands</h1>
            <p><strong>Kj√∏r CMD som administrator!</strong></p>

            
            <div id="cmd-container"></div>
        </div>
        <script>
            const sheetUrl = "https://script.googleusercontent.com/macros/echo?user_content_key=AehSKLgcb8v34c0trkkbtKD9o8fOdR9z0QWVQ5_A8Cg0ZpzHNyXx08H-Oyw7XTKxEw--ejVk9kWUXkUBRe6s_w-hNHbgTgvdquVKQiYQT5X0H5ciK0wLC7Uv9wfOoIyc3dFbwzeAIRVr8AK0tqvgHpvT1VYrV755u7gyaKSwwThTub0MvmvsPEf0wxMIHRm8EJt0cW9mWjs-yx0isoiAuWWd3nZXr_FJP9Mtfblu3lYGLWAqITgUEUVC_564-RzIf6LtdJDBa6uA5AGARkp3NNkL02wIEHHryQ&lib=MoPesbO-_SN0qATgGoC6Hbu_f9Eepb8L8";
        
            async function loadCommands() {
                const res = await fetch(sheetUrl);
                const text = await res.text();
                console.log("text: ", text);

                const data = JSON.parse(text);
                console.log("data:, ", data)

                // Grupper etter kategori
                const categories = {};
                data.forEach(item => {
                    if (!categories[item.Kategori]) categories[item.Kategori] = [];
                    categories[item.Kategori].push(item);
                });

                const container = document.getElementById("cmd-container");

                for (const category in categories) {
                    const items = categories[category];

                    let html = `<table>
                                    <tbody>
                                        <tr>
                                            <td colspan="2" style="padding:0;">
                                                <div class="tableHeading"><h2>${category}</h2></div>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td class="tableUnderHeadings"><strong>Command</strong></td>
                                            <td class="tableUnderHeadings"><strong>Beskrivelse</strong></td>
                                        </tr>`;

                    items.forEach(cmd => {
                        html += `<tr>
                                    <td><div class="command">${cmd.Command}</div></td>
                                    <td>${cmd.Beskrivelse}</td>
                                </tr>`;
                    });

                    html += `</tbody></table><br>`;
                    container.innerHTML += html;
                }

                // Copy-click
                document.querySelectorAll(".command").forEach(cmd => {
                    cmd.addEventListener("click", () => {
                        navigator.clipboard.writeText(cmd.textContent);
                        const original = cmd.textContent;
                        cmd.textContent = "Kopiert!";
                        setTimeout(() => cmd.textContent = original, 1000);
                    });
                });
            }
            loadCommands();
        </script>
    </body>
</html>